package com.proutechos.sandbox.radiolivealacarte.server.service.streaming;import java.io.File;import java.io.IOException;import java.text.SimpleDateFormat;import java.util.Date;import java.util.concurrent.TimeUnit;public class StreamingService {    public void recordWithSegments(int withSegments, String url) {        String timestamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());        String outputFileName;        String outputPath;        ProcessBuilder processBuilder;        Boolean withSegmentsBool;        if (withSegments == 1) {            withSegmentsBool = Boolean.TRUE;        } else {            withSegmentsBool = Boolean.FALSE;        }        //        // GESTION D'ERREURS À FAIRE ICI        //        if (withSegmentsBool) {            // Si withSegments est à TRUE, utiliser le segment time            outputFileName = "output_" + timestamp + "_%04d.mp3";            outputPath = "/Users/eglantine/Dev/0.perso/2.Proutechos/8.RadioStreaming/0.RadioLiveALaCarteServer/app/src/main/resources/static/media/mp3/" + outputFileName;            processBuilder = new ProcessBuilder(                    "ffmpeg",                    "-i", url,                    "-c:a", "libmp3lame",                    "-b:a", "192k",                    "-f", "mp3",                    "-f", "segment",                    "-segment_time", "10",                    outputPath            );        } else {            // Si withSegments est à FALSE, pas de segmentation            outputFileName = "output_nosegments_" + timestamp + ".mp3";            outputPath = "/Users/eglantine/Dev/0.perso/2.Proutechos/8.RadioStreaming/0.RadioLiveALaCarteServer/app/src/main/resources/static/media/mp3/" + outputFileName;            processBuilder = new ProcessBuilder(                    "ffmpeg",                    "-i", url,                    "-c:a", "libmp3lame",                    "-b:a", "192k",                    outputPath // Spécifiez le fichier unique ici (ex : "output.mp3")            );        }        processBuilder.redirectErrorStream(true);        processBuilder.directory(new File("/Users/eglantine/Dev/0.perso/2.Proutechos/8.RadioStreaming/0.RadioLiveALaCarteServer/app/src/main/resources/static/media/mp3"));        try {            Process process = processBuilder.start();            System.out.println("Enregistrement en cours dans : " + outputFileName);            // Attendre 30 secondes (ou une durée de votre choix)            Thread.sleep(30000);            // Arrêter le processus FFmpeg            process.destroy();            process.waitFor(5, TimeUnit.SECONDS);            if (process.isAlive()) {                process.destroyForcibly();            }            System.out.println("Enregistrement terminé.");            int exitCode = process.waitFor();            System.out.println("FFmpeg s'est terminé avec le code de sortie : " + exitCode);        } catch (IOException | InterruptedException e) {            e.printStackTrace();        }    }    //    //    // IMPLEMENTATION    //    //    //    //    // SINGLETON    //    //    private static StreamingService _instance = new StreamingService();    public static StreamingService getInstance() {        return _instance;    }}